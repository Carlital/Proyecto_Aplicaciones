<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Vista de configuraci√≥n de CV -->
    <record id="view_cv_config_form" model="ir.ui.view">
        <field name="name">cv.config.form</field>
        <field name="model">cv.config</field>
        <field name="arch" type="xml">
            <form string="Configuraci√≥n de CV Importer">
                <group>
                    <group string="Configuraci√≥n N8N (Free Trial)">
                        <field name="n8n_webhook_url" placeholder="https://n8n.pruebasbidata.site/webhook/process-cv"/>
                        <field name="n8n_api_key" password="True" invisible="True"/>
                        <div class="alert alert-info" style="margin: 5px 0;">
                            <small><strong>‚ÑπÔ∏è Free Trial:</strong> N8N Free Trial no incluye API key - solo webhook funciona</small>
                        </div>
                    </group>
                    <group string="Procesamiento Local">
                        <field name="local_development"/>
                        <field name="ngrok_url" placeholder="https://abc123.ngrok-free.app" invisible="not local_development"/>
                    </group>
                </group>
                
                <div class="alert alert-info">
                    <strong>Configuraci√≥n para Desarrollo Local (Localhost:8076):</strong>
                    <ul>
                        <li><strong>N8N URL:</strong> https://n8n.pruebasbidata.site/webhook/process-cv (en l√≠nea)</li>
                        <li><strong>Procesamiento PDF:</strong> Local usando PyPDF2 y pdfplumber</li>
                        <li><strong>Ngrok URL:</strong> Para recibir callbacks de N8N en tu Odoo local</li>
                        <li><strong>Setup:</strong> 
                            <ol>
                                <li>Instala ngrok: <code>npm install -g ngrok</code></li>
                                <li>Ejecuta: <code>ngrok http 8076</code></li>
                                <li>Copia la URL https://xxx.ngrok-free.app</li>
                                <li>P√©gala en "URL Ngrok" arriba</li>
                            </ol>
                        </li>
                    </ul>
                    <strong>Flujo:</strong> Odoo (localhost) ‚Üí Procesamiento Local ‚Üí N8N (online) ‚Üí Ngrok ‚Üí Odoo (localhost)
                </div>
                
                <div class="alert alert-warning">
                    <strong>‚ö†Ô∏è Sin Ngrok:</strong> El procesamiento local y N8N funcionar√°n pero los resultados no volver√°n autom√°ticamente a Odoo.
                </div>
                
                <footer>
                    <button string="üìã Gu√≠a Setup Local" type="object" name="action_setup_local_development" class="btn-info" invisible="not local_development"/>
                    <button string="Probar N8N" type="object" name="action_test_n8n" class="btn-info"/>
                    <button string="Guardar" special="save" class="btn-primary"/>
                    <button string="Cancelar" class="btn-secondary" special="cancel"/>
                </footer>
            </form>
        </field>
    </record>

    <!-- Vista lista de configuraciones -->
    <record id="view_cv_config_tree" model="ir.ui.view">
        <field name="name">cv.config.tree</field>
        <field name="model">cv.config</field>
        <field name="arch" type="xml">
            <tree string="Configuraciones CV">
                <field name="id"/>
                <field name="n8n_webhook_url"/>
                <field name="local_development"/>
            </tree>
        </field>
    </record>

    <!-- Acci√≥n para configuraci√≥n -->
    <record id="action_cv_config" model="ir.actions.act_window">
        <field name="name">Configuraci√≥n CV</field>
        <field name="res_model">cv.config</field>
        <field name="view_mode">tree,form</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Configura la integraci√≥n con N8N y el procesamiento local de PDFs
            </p>
        </field>
    </record>

    <!-- Men√∫ de configuraci√≥n -->
    <menuitem id="menu_cv_config" name="Configuraci√≥n CV" parent="menu_cv_importer_root" 
              action="action_cv_config" sequence="25"/>
</odoo>
